{"version":3,"file":"bim-engine-sdk.umd.js","sources":["../src/locales/zh-CN.ts","../src/locales/en-US.ts","../src/services/locale.ts","../src/themes/presets.ts","../src/services/theme.ts","../src/components/button-group/index.ts","../src/components/button-group/toolbar/index.ts","../src/managers/toolbar-manager.ts","../src/managers/button-group-manager.ts","../src/components/dialog/index.ts","../src/components/dialog/bimInfoDialog/index.ts","../src/managers/dialog-manager.ts","../src/bim-engine.ts","../src/components/button-group/toolbar/buttons/home/index.ts","../src/components/button-group/toolbar/buttons/location/index.ts","../src/components/button-group/toolbar/buttons/walk/walk-menu/index.ts","../src/components/button-group/toolbar/buttons/walk/walk-person/index.ts","../src/components/button-group/toolbar/buttons/walk/walk-bird/index.ts","../src/components/button-group/toolbar/buttons/setting/index.ts","../src/components/button-group/toolbar/buttons/info/index.ts"],"sourcesContent":["import { TranslationDictionary } from './types';\n\nexport const zhCN: TranslationDictionary = {\n  common: {\n    title: 'BimEngine',\n    description: '这是一个使用 BIM-ENGINE。',\n    openTestDialog: '打开测试弹窗',\n    openInfoDialog: '打开信息弹窗 (封装版)',\n  },\n  toolbar: {\n    home: '首页',\n    info: '信息',\n    location: '定位',\n    setting: '设置',\n    walk: '漫游',\n    walkPerson: '人视',\n    walkBird: '鸟瞰',\n    walkMenu: '菜单',\n  },\n  dialog: {\n    testTitle: '测试弹窗',\n    testContent: '<div style=\"padding: 10px;\">这是一个 <b>可拖拽</b> 且 <b>可缩放</b> 的弹窗。<br><br>你可以尝试拖动标题栏，或者拖动右下角改变大小。</div>',\n  },\n};\n","import { TranslationDictionary } from './types';\n\nexport const enUS: TranslationDictionary = {\n  common: {\n    title: 'BimEngine',\n    description: 'This is a BIM-ENGINE demo.',\n    openTestDialog: 'Open Test Dialog',\n    openInfoDialog: 'Open Info Dialog (Wrapped)',\n  },\n  toolbar: {\n    home: 'Home',\n    info: 'Info',\n    location: 'Location',\n    setting: 'Settings',\n    walk: 'Walk',\n    walkPerson: 'Person',\n    walkBird: 'Bird Eye',\n    walkMenu: 'Menu',\n  },\n  dialog: {\n    testTitle: 'Test Dialog',\n    testContent: '<div style=\"padding: 10px;\">This is a <b>draggable</b> and <b>resizable</b> dialog.<br><br>Try dragging the title bar or resizing from the bottom-right corner.</div>',\n  },\n};\n","import { LocaleType, TranslationDictionary } from '../locales/types';\nimport { zhCN } from '../locales/zh-CN';\nimport { enUS } from '../locales/en-US';\n\ntype LocaleChangeListener = (locale: LocaleType) => void;\n\n/**\n * 语言管理器类\n */\nexport class LocaleManager {\n  private currentLocale: LocaleType = 'zh-CN';\n  private messages: Record<LocaleType, TranslationDictionary> = {\n    'zh-CN': zhCN,\n    'en-US': enUS,\n  };\n  private listeners: LocaleChangeListener[] = [];\n\n  constructor() {\n    // 默认初始化\n  }\n\n  /**\n   * 获取当前语言\n   */\n  public getLocale(): LocaleType {\n    return this.currentLocale;\n  }\n\n  /**\n   * 切换语言\n   */\n  public setLocale(locale: LocaleType) {\n    if (this.currentLocale === locale) return;\n    this.currentLocale = locale;\n    this.notifyListeners();\n  }\n\n  /**\n   * 翻译核心方法\n   */\n  public t(key: string): string {\n    if (!key) return '';\n    \n    const keys = key.split('.');\n    let value: any = this.messages[this.currentLocale];\n    \n    for (const k of keys) {\n      if (value && typeof value === 'object' && k in value) {\n        value = value[k];\n      } else {\n        return key;\n      }\n    }\n    return value as string;\n  }\n\n  /**\n   * 订阅变更\n   */\n  public subscribe(listener: LocaleChangeListener): () => void {\n    this.listeners.push(listener);\n    return () => {\n      this.listeners = this.listeners.filter(l => l !== listener);\n    };\n  }\n\n  private notifyListeners() {\n    this.listeners.forEach(listener => listener(this.currentLocale));\n  }\n}\n\n// --- 导出单例 ---\nexport const localeManager = new LocaleManager();\n\n// --- 导出便捷方法 ---\n/**\n * 全局翻译函数\n * @param key 键路径 (如 'toolbar.home')\n */\nexport const t = (key: string): string => localeManager.t(key);\n","import { ThemeConfig } from './types';\n\n/**\n * 深色主题 (默认)\n */\nexport const darkTheme: ThemeConfig = {\n    name: 'dark',\n    primary: '#0078d4',\n    primaryHover: '#0063b1',\n    \n    // 修改：背景色统一为浅灰，不再跟随深色模式变黑\n    background: '#f5f5f5', \n    panelBackground: 'rgba(30, 30, 30, 0.9)',\n    \n    // 注意：如果背景是浅色，主文字颜色通常需要是深色才能看清\n    // 但这里的 textPrimary 主要是用于 UI 组件内部的。\n    // 如果 BimEngine wrapper 上的文字直接显示在 background 上，\n    // 我们可能需要区分 \"UI文字\" 和 \"页面文字\"。\n    // 目前架构中：\n    // theme.textPrimary 会应用到 wrapper.style.color (BimEngine.ts)\n    // 以及 Toolbar/Dialog 的文字颜色。\n    \n    // 如果背景是浅灰，而 wrapper 文字设置为白色 (#ffffff)，那就看不清了。\n    // 这是一个语义冲突：\n    // 1. Panel (Toolbar/Dialog) 是黑底，需要白字。\n    // 2. Background (Wrapper) 是白底，需要黑字。\n    \n    // 既然您要求背景统一浅灰，那么 Wrapper 上的“直接子文本”应该是深色。\n    // 但 Toolbar/Dialog 仍然是深色模式（黑底），它们需要白字。\n    \n    // 妥协方案：\n    // 保持 textPrimary 为白色（为了适配黑���的 Toolbar/Dialog）。\n    // 但是在 BimEngine 中，如果背景强制改为浅色，Wrapper 的默认文字颜色可能需要单独处理，\n    // 或者我们可以认为 \"Wrapper\" 主要是承载 UI 组件的，直接写在 Wrapper 上的文字（标题/描述）\n    // 应该有自己的样式，而不是直接继承 theme.textPrimary。\n    \n    // 在之前的 BimEngine.ts 中：\n    // this.wrapper.style.color = theme.textPrimary;\n    \n    // 如果背景变浅灰，这里 textPrimary 还是白色的话，标题就看不见了。\n    // 所以，深色模式下：\n    // 背景：浅灰\n    // 组件：深黑\n    // 组件文字：白\n    // 页面文字：黑 (问题点)\n    \n    // 让我们先按您的要求改背景。通常这种情况下，ThemeConfig 可能需要区分 \n    // contentText (页面内容文字) 和 uiText (组件文字)。\n    // 但为了不破坏现有结构，我将假定 textPrimary 主要服务于 UI 组件。\n    // 为了让 Wrapper 上的标题可见，我们可能需要在 BimEngine 中移除对 wrapper.style.color 的强制设置，\n    // 或者在 presets 里把 textPrimary 改回来？不对，改回来 Toolbar 就看不清了。\n    \n    // 方案：我将仅修改 background。\n    // 至于 Wrapper 上的标题（BimEngine 标题），由于在最新的 BimEngine.ts 中\n    // ���们已经移除了 titleEl 和 descEl（在之前的重构中），\n    // 所以现在 Wrapper 里主要是 Toolbar 和 Dialog，它们有自己的 panelBackground。\n    // 只要 Toolbar/Dialog 内部正常即可。\n    \n    textPrimary: '#ffffff', \n    textSecondary: '#cccccc',\n    \n    border: '#444444',\n    \n    icon: '#cccccc',\n    iconActive: '#ffffff',\n    \n    componentBackground: 'transparent',\n    componentHover: '#333333',\n    componentActive: 'rgba(255, 255, 255, 0.1)'\n};\n\n/**\n * 浅色主题\n */\nexport const lightTheme: ThemeConfig = {\n    name: 'light',\n    primary: '#0078d4',\n    primaryHover: '#106ebe',\n    \n    // 统一为浅灰\n    background: '#f5f5f5',\n    panelBackground: '#ffffff',\n    \n    textPrimary: '#333333',\n    textSecondary: '#666666',\n    \n    border: '#e0e0e0',\n    \n    icon: '#555555',\n    iconActive: '#0078d4',\n    \n    componentBackground: 'transparent',\n    componentHover: '#f0f0f0',\n    componentActive: '#e0e0e0'\n};","import { ThemeConfig } from '../themes/types';\nimport { darkTheme, lightTheme } from '../themes/presets';\n\ntype ThemeChangeListener = (theme: ThemeConfig) => void;\n\n/**\n * 主题管理器 (单例)\n */\nexport class ThemeManager {\n    private currentTheme: ThemeConfig = darkTheme;\n    private listeners: ThemeChangeListener[] = [];\n\n    constructor() {\n        // 默认初始化\n    }\n\n    /**\n     * 获取当前主题配置\n     */\n    public getTheme(): ThemeConfig {\n        return this.currentTheme;\n    }\n\n    /**\n     * 切换预设主题\n     * @param themeName 'dark' | 'light'\n     */\n    public setTheme(themeName: 'dark' | 'light') {\n        if (themeName === 'light') {\n            this.applyTheme(lightTheme);\n        } else {\n            this.applyTheme(darkTheme);\n        }\n    }\n\n    /**\n     * 应用自定义主题配置\n     * @param theme 配置对象\n     */\n    public setCustomTheme(theme: ThemeConfig) {\n        this.applyTheme(theme);\n    }\n\n    /**\n     * 内部应用主题逻辑\n     */\n    private applyTheme(theme: ThemeConfig) {\n        this.currentTheme = theme;\n        this.notifyListeners();\n    }\n\n    /**\n     * 订阅主题变更\n     */\n    public subscribe(listener: ThemeChangeListener): () => void {\n        this.listeners.push(listener);\n        // 立即回调一次当前状态\n        listener(this.currentTheme);\n        return () => {\n            this.listeners = this.listeners.filter(l => l !== listener);\n        };\n    }\n\n    private notifyListeners() {\n        this.listeners.forEach(listener => listener(this.currentTheme));\n    }\n}\n\n// 导出单例\nexport const themeManager = new ThemeManager();","import './index.css';\nimport type {\n    OptButton,\n    ButtonGroup,\n    ButtonGroupOptions,\n    ButtonConfig,\n    ButtonGroupColors\n} from './index.type';\nimport { t, localeManager } from '../../services/locale';\nimport { themeManager } from '../../services/theme';\nimport type { ThemeConfig } from '../../themes/types';\nimport { IBimComponent } from '../../types/component';\n\n/**\n * 通用按钮组组件 (BimButtonGroup)\n */\nexport class BimButtonGroup implements IBimComponent {\n    private container: HTMLElement;\n    private options: ButtonGroupOptions;\n    private groups: ButtonGroup[] = [];\n    private activeBtnIds: Set<string> = new Set();\n    private btnRefs: Map<string, HTMLElement> = new Map();\n    private dropdownElement: HTMLElement | null = null;\n    private hoverTimeout: number | null = null;\n    private customColors: Set<keyof ButtonGroupColors> = new Set(); // 记录用户自定义的颜色属性\n    private unsubscribeLocale: (() => void) | null = null;\n    private unsubscribeTheme: (() => void) | null = null;\n\n    private readonly DEFAULT_ICON = '<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\" ry=\"2\"></rect></svg>';\n\n    constructor(options: ButtonGroupOptions) {\n        const el = typeof options.container === 'string'\n            ? document.getElementById(options.container)\n            : options.container;\n\n        if (!el) throw new Error('Container not found');\n\n        this.container = el;\n        // 合并默认配置\n        this.options = {\n            showLabel: true,\n            visibility: {},\n            direction: 'row', // 默认横向\n            position: 'static',   // 默认静态定位\n            align: 'vertical',    // 默认图标在上\n            expand: 'down',       // 默认向下展开\n            ...options\n        };\n\n        // 记录初始传入的自定义颜色\n        const colorKeys: (keyof ButtonGroupColors)[] = [\n            'backgroundColor', 'btnBackgroundColor', 'btnHoverColor',\n            'btnActiveColor', 'iconColor', 'iconActiveColor',\n            'textColor', 'textActiveColor'\n        ];\n        colorKeys.forEach(key => {\n            if (options[key]) {\n                this.customColors.add(key);\n            }\n        });\n\n        this.initContainer();\n        this.applyStyles();\n    }\n\n    private initContainer(): void {\n        this.container.innerHTML = '';\n        this.container.classList.add('bim-btn-group-root');\n\n        if (this.options.direction === 'column') {\n            this.container.classList.add('dir-column');\n        } else {\n            this.container.classList.add('dir-row');\n        }\n\n        if (this.options.className) {\n            this.container.classList.add(this.options.className);\n        }\n\n        this.updatePosition();\n    }\n\n    private updatePosition() {\n        const pos = this.options.position;\n        const style = this.container.style;\n\n        style.top = ''; style.bottom = ''; style.left = ''; style.right = ''; style.transform = '';\n\n        if (pos === 'static') {\n            this.container.classList.add('static');\n            return;\n        }\n\n        this.container.classList.remove('static');\n        this.container.style.position = 'absolute';\n\n        if (typeof pos === 'object' && 'x' in pos) {\n            style.left = `${pos.x}px`;\n            style.top = `${pos.y}px`;\n        } else {\n            const margin = '20px';\n            switch (pos) {\n                case 'top-left':\n                    style.top = margin; style.left = margin;\n                    break;\n                case 'top-center':\n                    style.top = margin; style.left = '50%'; style.transform = 'translateX(-50%)';\n                    break;\n                case 'top-right':\n                    style.top = margin; style.right = margin;\n                    break;\n                case 'bottom-left':\n                    style.bottom = margin; style.left = margin;\n                    break;\n                case 'bottom-center':\n                    style.bottom = margin; style.left = '50%'; style.transform = 'translateX(-50%)';\n                    break;\n                case 'bottom-right':\n                    style.bottom = margin; style.right = margin;\n                    break;\n                case 'left-center':\n                    style.left = margin; style.top = '50%'; style.transform = 'translateY(-50%)';\n                    break;\n                case 'right-center':\n                    style.right = margin; style.top = '50%'; style.transform = 'translateY(-50%)';\n                    break;\n                case 'center':\n                    style.top = '50%'; style.left = '50%'; style.transform = 'translate(-50%, -50%)';\n                    break;\n            }\n        }\n    }\n\n    /**\n     * 应用样式到容器\n     */\n    private applyStyles(): void {\n        const style = this.container.style;\n        if (this.options.backgroundColor) style.setProperty('--bim-btn-group-section-bg', this.options.backgroundColor);\n        if (this.options.btnBackgroundColor) style.setProperty('--bim-btn-bg', this.options.btnBackgroundColor);\n        if (this.options.btnHoverColor) style.setProperty('--bim-btn-hover-bg', this.options.btnHoverColor);\n        if (this.options.btnActiveColor) style.setProperty('--bim-btn-active-bg', this.options.btnActiveColor);\n        if (this.options.iconColor) style.setProperty('--bim-icon-color', this.options.iconColor);\n        if (this.options.iconActiveColor) style.setProperty('--bim-icon-active-color', this.options.iconActiveColor);\n        if (this.options.textColor) style.setProperty('--bim-btn-text-color', this.options.textColor);\n        if (this.options.textActiveColor) style.setProperty('--bim-btn-text-active-color', this.options.textActiveColor);\n    }\n\n    /**\n     * 设置主题颜色\n     * 只会应用到没有被用户自定义的颜色属性上\n     */\n    public setTheme(theme: ThemeConfig): void {\n        const themeColors: ButtonGroupColors = {\n            backgroundColor: theme.panelBackground,\n            btnBackgroundColor: theme.componentBackground,\n            btnHoverColor: theme.componentHover,\n            btnActiveColor: theme.componentActive,\n            iconColor: theme.icon,\n            iconActiveColor: theme.iconActive,\n            textColor: theme.textSecondary,\n            textActiveColor: theme.textPrimary\n        };\n\n        // 只应用没有被自定义的颜色\n        Object.entries(themeColors).forEach(([key, value]) => {\n            const colorKey = key as keyof ButtonGroupColors;\n            if (!this.customColors.has(colorKey)) {\n                this.options[colorKey] = value;\n            }\n        });\n\n        this.applyStyles();\n    }\n\n    /**\n     * 直接设置颜色（强制覆盖）\n     * 设置的颜色会被标记为自定义，后续的 setTheme 不会覆盖它们\n     */\n    public setColors(colors: ButtonGroupColors): void {\n        // 更新 options\n        this.options = { ...this.options, ...colors };\n\n        // 标记这些颜色为自定义\n        Object.keys(colors).forEach(key => {\n            this.customColors.add(key as keyof ButtonGroupColors);\n        });\n\n        this.applyStyles();\n    }\n\n    public async init(): Promise<void> {\n        this.render();\n\n        // 自动订阅语言变更\n        this.unsubscribeLocale = localeManager.subscribe(() => {\n            this.setLocales();\n        });\n\n        // 自动订阅主题变更\n        this.unsubscribeTheme = themeManager.subscribe((theme) => {\n            this.setTheme(theme);\n        });\n    }\n\n    public setLocales(): void {\n        this.render();\n    }\n\n    public addGroup(groupId: string, beforeGroupId?: string): void {\n        if (this.groups.some(g => g.id === groupId)) return;\n        const newGroup: ButtonGroup = { id: groupId, buttons: [] };\n        if (beforeGroupId) {\n            const index = this.groups.findIndex(g => g.id === beforeGroupId);\n            index !== -1 ? this.groups.splice(index, 0, newGroup) : this.groups.push(newGroup);\n        } else {\n            this.groups.push(newGroup);\n        }\n    }\n\n    public addButton(config: ButtonConfig): void {\n        const { groupId, parentId } = config;\n        const group = this.groups.find(g => g.id === groupId);\n        if (!group) return;\n\n        const button: OptButton = { ...config, children: config.children || [] };\n        if (parentId) {\n            const parentBtn = this.findButton(group.buttons, parentId);\n            if (parentBtn) {\n                if (!parentBtn.children) parentBtn.children = [];\n                parentBtn.children.push(button);\n            }\n        } else {\n            group.buttons.push(button);\n        }\n    }\n\n    private findButton(buttons: OptButton[], id: string): OptButton | undefined {\n        for (const btn of buttons) {\n            if (btn.id === id) return btn;\n            if (btn.children) {\n                const found = this.findButton(btn.children, id);\n                if (found) return found;\n            }\n        }\n        return undefined;\n    }\n\n    public render(): void {\n        this.container.innerHTML = '';\n        this.btnRefs.clear();\n\n        this.groups.forEach((group, index) => {\n            const groupElement = this.renderGroup(group, index, this.groups.length);\n            this.container.appendChild(groupElement);\n        });\n    }\n\n    private renderGroup(group: ButtonGroup, index: number, total: number): HTMLElement {\n        const groupEl = document.createElement('div');\n        groupEl.className = 'bim-btn-group-section';\n\n        if (index < total - 1) {\n            groupEl.classList.add('has-divider');\n        }\n\n        group.buttons.forEach(button => {\n            if (this.isVisible(button.id)) {\n                const btnWrapper = this.renderButton(button);\n                groupEl.appendChild(btnWrapper);\n            }\n        });\n        return groupEl;\n    }\n\n    private renderButton(button: OptButton): HTMLElement {\n        const wrapper = document.createElement('div');\n        wrapper.className = 'opt-btn-wrapper';\n\n        const btnEl = document.createElement('div');\n        btnEl.className = 'opt-btn';\n\n        // 按钮优先使用自己的 align，否则使用全局配置，默认为 vertical\n        const align = button.align || this.options.align || 'vertical';\n        if (align === 'horizontal') {\n            btnEl.classList.add('align-horizontal');\n        } else {\n            btnEl.classList.add('align-vertical');\n        }\n\n        if (this.activeBtnIds.has(button.id)) btnEl.classList.add('active');\n        if (button.disabled) btnEl.classList.add('disabled');\n\n        // 判断是否显示 label\n        const hasLabel = this.options.showLabel && button.label;\n        if (!hasLabel) {\n            btnEl.classList.add('no-label');\n        }\n\n        // 应用按钮的自定义样式\n        const iconSize = button.iconSize || 32;\n        const minWidth = button.minWidth || 50;\n        btnEl.style.minWidth = `${minWidth}px`;\n\n        const icon = document.createElement('div');\n        icon.className = 'opt-btn-icon';\n        icon.style.width = `${iconSize}px`;\n        icon.style.height = `${iconSize}px`;\n        icon.innerHTML = this.getIcon(button.icon);\n        btnEl.appendChild(icon);\n\n        // 创建文字和箭头的容器，确保它们始终在一起（无论主轴是横是竖）\n        const textWrapper = document.createElement('div');\n        textWrapper.className = 'opt-btn-text-wrapper';\n\n        if (this.options.showLabel && button.label) {\n            const label = document.createElement('span');\n            label.className = 'opt-btn-label';\n            label.textContent = t(button.label);\n            textWrapper.appendChild(label);\n        }\n\n        if (button.children && button.children.length > 0) {\n            const arrow = document.createElement('span');\n            arrow.className = 'opt-btn-arrow';\n            arrow.textContent = '▼';\n            textWrapper.appendChild(arrow);\n        }\n\n        // 只有当有内容时才添加 wrapper\n        if (textWrapper.hasChildNodes()) {\n            btnEl.appendChild(textWrapper);\n        }\n\n        btnEl.addEventListener('click', () => this.handleClick(button));\n        btnEl.addEventListener('mouseenter', () => this.handleMouseEnter(button, btnEl));\n        btnEl.addEventListener('mouseleave', () => this.handleMouseLeave());\n\n        this.btnRefs.set(button.id, btnEl);\n        wrapper.appendChild(btnEl);\n        return wrapper;\n    }\n\n    private handleClick(button: OptButton): void {\n        if (button.disabled) return;\n        if (!button.children || button.children.length === 0) {\n            if (button.keepActive) {\n                const wasActive = this.activeBtnIds.has(button.id);\n                if (wasActive) this.activeBtnIds.delete(button.id);\n                else this.activeBtnIds.add(button.id);\n                this.updateButtonState(button.id);\n            }\n            this.closeDropdown();\n            if (button.onClick) button.onClick(button);\n        }\n    }\n\n    private handleMouseEnter(button: OptButton, btnEl: HTMLElement): void {\n        if (this.hoverTimeout) clearTimeout(this.hoverTimeout);\n        if (button.children && button.children.length > 0) {\n            this.showDropdown(button, btnEl);\n        } else {\n            this.closeDropdown();\n        }\n    }\n\n    private handleMouseLeave(): void {\n        this.hoverTimeout = window.setTimeout(() => this.closeDropdown(), 200);\n    }\n\n    private showDropdown(button: OptButton, btnEl: HTMLElement): void {\n        this.closeDropdown();\n        if (!button.children) return;\n\n        const dropdown = document.createElement('div');\n        dropdown.className = 'opt-btn-dropdown';\n        if (this.options.backgroundColor) dropdown.style.setProperty('--bim-toolbar-bg', this.options.backgroundColor);\n\n        // 获取按钮的位置信息\n        const btnRect = btnEl.getBoundingClientRect();\n        const expand = this.options.expand || 'down';\n\n        // 根据主按钮组的方向设置下拉菜单的布局方向\n        if (this.options.direction === 'row') {\n            dropdown.style.flexDirection = 'column'; // 横向按钮组，菜单纵向排列\n        } else {\n            dropdown.style.flexDirection = 'row'; // 纵向按钮组，菜单横向排列\n        }\n\n        // 先添加到 DOM 以便计算尺寸\n        document.body.appendChild(dropdown);\n\n        // 添加菜单项\n        button.children.forEach(subBtn => {\n            if (this.isVisible(subBtn.id)) {\n                const item = this.renderDropdownItem(subBtn);\n                dropdown.appendChild(item);\n            }\n        });\n\n        // 获取下拉菜单的实际尺寸\n        const dropdownRect = dropdown.getBoundingClientRect();\n\n        if (expand === 'up') {\n            // 向上展开，与按钮水平居中对齐\n            dropdown.style.bottom = (window.innerHeight - btnRect.top + 8) + 'px';\n            dropdown.style.left = (btnRect.left + (btnRect.width - dropdownRect.width) / 2) + 'px';\n        } else if (expand === 'down') {\n            // 向下展开，与按钮水平居中对齐\n            dropdown.style.top = (btnRect.bottom + 8) + 'px';\n            dropdown.style.left = (btnRect.left + (btnRect.width - dropdownRect.width) / 2) + 'px';\n        } else if (expand === 'right') {\n            // 向右展开，与按钮垂直居中对齐\n            dropdown.style.top = (btnRect.top + (btnRect.height - dropdownRect.height) / 2) + 'px';\n            dropdown.style.left = (btnRect.right + 8) + 'px';\n        } else if (expand === 'left') {\n            // 向左展开，与按钮垂直居中对齐\n            dropdown.style.top = (btnRect.top + (btnRect.height - dropdownRect.height) / 2) + 'px';\n            dropdown.style.right = (window.innerWidth - btnRect.left + 8) + 'px';\n        }\n\n        dropdown.addEventListener('mouseenter', () => { if (this.hoverTimeout) clearTimeout(this.hoverTimeout); });\n        dropdown.addEventListener('mouseleave', () => this.handleMouseLeave());\n        this.dropdownElement = dropdown;\n    }\n\n    private renderDropdownItem(button: OptButton): HTMLElement {\n        const item = document.createElement('div');\n        item.className = 'opt-btn-dropdown-item';\n\n        // 应用按钮的 align 设置，默认为 horizontal（图标在左）\n        const align = button.align || 'horizontal';\n        if (align === 'horizontal') {\n            item.classList.add('align-horizontal');\n        } else {\n            item.classList.add('align-vertical');\n        }\n\n        // 应用按钮的自定义样式\n        const iconSize = button.iconSize || 32; // 二级菜单默认图标更小\n        const minWidth = button.minWidth; // 不设置默认值，让下拉菜单项保持紧凑\n        if (minWidth) {\n            item.style.minWidth = `${minWidth}px`;\n        }\n\n        const icon = document.createElement('div');\n        icon.className = 'opt-btn-icon';\n        icon.style.width = `${iconSize}px`;\n        icon.style.height = `${iconSize}px`;\n        icon.innerHTML = this.getIcon(button.icon);\n        item.appendChild(icon);\n\n        // 只有在 showLabel 为 true 时才显示 label\n        if (this.options.showLabel && button.label) {\n            const label = document.createElement('span');\n            label.className = 'opt-btn-dropdown-label';\n            label.textContent = t(button.label);\n            item.appendChild(label);\n        }\n\n        item.addEventListener('click', (e) => { e.stopPropagation(); this.handleClick(button); });\n        return item;\n    }\n\n    private closeDropdown(): void {\n        if (this.dropdownElement) {\n            this.dropdownElement.remove();\n            this.dropdownElement = null;\n        }\n        this.btnRefs.forEach(btnEl => {\n            const arrow = btnEl.querySelector('.opt-btn-arrow');\n            if (arrow) arrow.classList.remove('rotated');\n        });\n    }\n\n    private updateButtonState(buttonId: string): void {\n        const btnEl = this.btnRefs.get(buttonId);\n        if (btnEl) {\n            this.activeBtnIds.has(buttonId) ? btnEl.classList.add('active') : btnEl.classList.remove('active');\n        }\n    }\n\n    private getIcon(icon?: string): string { return icon || this.DEFAULT_ICON; }\n    public updateButtonVisibility(id: string, visible: boolean): void {\n        if (!this.options.visibility) this.options.visibility = {};\n        this.options.visibility[id] = visible;\n        this.render();\n    }\n    public setShowLabel(show: boolean): void {\n        this.options.showLabel = show;\n        this.updateLabelsVisibility();\n    }\n\n    private updateLabelsVisibility(): void {\n        this.btnRefs.forEach((btnEl, buttonId) => {\n            // 查找按钮配置\n            const button = this.findButtonById(buttonId);\n            if (!button) return;\n\n            const hasLabel = this.options.showLabel && button.label;\n\n            // 只需要更新 no-label 类，CSS 会处理显示/隐藏\n            if (hasLabel) {\n                btnEl.classList.remove('no-label');\n            } else {\n                btnEl.classList.add('no-label');\n            }\n        });\n    }\n\n    private findButtonById(id: string): OptButton | undefined {\n        for (const group of this.groups) {\n            const found = this.findButton(group.buttons, id);\n            if (found) return found;\n        }\n        return undefined;\n    }\n    public setBackgroundColor(color: string): void { this.setColors({ backgroundColor: color }); }\n    private isVisible(id: string): boolean { return this.options.visibility?.[id] !== false; }\n    public destroy(): void {\n        if (this.unsubscribeLocale) {\n            this.unsubscribeLocale();\n            this.unsubscribeLocale = null;\n        }\n        if (this.unsubscribeTheme) {\n            this.unsubscribeTheme();\n            this.unsubscribeTheme = null;\n        }\n        this.closeDropdown();\n        this.container.innerHTML = '';\n        this.btnRefs.clear();\n    }\n}\n","import { BimButtonGroup } from '../index';\n\n/**\n * 底部工具栏 (Toolbar)\n * BimButtonGroup 的子类，专门用于加载工具栏默认按钮。\n */\nexport class Toolbar extends BimButtonGroup {\n    /**\n     * 重写初始化，加载默认按钮\n     */\n    public async init(): Promise<void> {\n        await super.init();\n\n        // 动态加载默认按钮配置\n        const { homeButton } = await import('./buttons/home');\n        const { locationButton } = await import('./buttons/location');\n        const { walkMenuButton } = await import('./buttons/walk/walk-menu');\n        const { walkPersonButton } = await import('./buttons/walk/walk-person');\n        const { walkBirdButton } = await import('./buttons/walk/walk-bird');\n        const { settingButton } = await import('./buttons/setting');\n        const { infoButton } = await import('./buttons/info');\n\n        this.addGroup('group-1');\n        this.addButton(homeButton);\n        this.addButton(walkMenuButton);\n        this.addButton(walkPersonButton);\n        this.addButton(walkBirdButton);\n        this.addButton(locationButton);\n        this.addGroup('group-2');\n        this.addButton(settingButton);\n        this.addButton(infoButton);\n\n        this.render();\n    }\n}\n","import type { ButtonGroupColors, ButtonConfig } from '../components/button-group/index.type';\nimport { Toolbar } from '../components/button-group/toolbar';\nimport type { ThemeConfig } from '../themes/types';\n\n/**\n * 底部工具栏管理器 (ToolbarManager)\n * 仅负责管理底部工具栏实例。\n */\nexport class ToolbarManager {\n    private toolbar: Toolbar | null = null;\n    private toolbarContainer: HTMLElement | null = null;\n    private container: HTMLElement;\n\n    constructor(container: HTMLElement) {\n        this.container = container;\n        this.init();\n    }\n\n    private init() {\n        // 创建底部工具栏专用容器\n        this.toolbarContainer = document.createElement('div');\n        this.toolbarContainer.id = 'opt-btn-groups';\n        this.toolbarContainer.className = 'bim-engine-opt-btn-container is-bottom-toolbar';\n        this.container.appendChild(this.toolbarContainer);\n\n        this.toolbar = new Toolbar({\n            container: this.toolbarContainer,\n            showLabel: true,\n            direction: 'row',\n            position: 'bottom-center', // 底部居中\n            align: 'vertical',         // 图标在上\n            expand: 'up'               // 向上展开\n        });\n\n        this.toolbar.init();\n    }\n\n    public updateTheme(theme: ThemeConfig) {\n        this.toolbar?.setTheme(theme);\n    }\n\n    public refresh() {\n        this.toolbar?.render();\n    }\n\n    public destroy() {\n        this.toolbar?.destroy();\n        this.toolbar = null;\n    }\n\n    // --- 转发 API ---\n    public addGroup(groupId: string, beforeGroupId?: string) { this.toolbar?.addGroup(groupId, beforeGroupId); this.toolbar?.render(); }\n    public addButton(config: ButtonConfig) { this.toolbar?.addButton(config); this.toolbar?.render(); }\n    public setButtonVisibility(id: string, v: boolean) { this.toolbar?.updateButtonVisibility(id, v); }\n    public setShowLabel(show: boolean) { this.toolbar?.setShowLabel(show); }\n    public setVisible(visible: boolean) {\n        if (this.toolbarContainer) {\n            this.toolbarContainer.style.visibility = visible ? 'visible' : 'hidden';\n        }\n    }\n    public setBackgroundColor(color: string) { this.toolbar?.setBackgroundColor(color); }\n    public setColors(colors: ButtonGroupColors) { this.toolbar?.setColors(colors); }\n}\n","import { BimButtonGroup } from '../components/button-group';\nimport type { ButtonGroupOptions } from '../components/button-group/index.type';\nimport type { ThemeConfig } from '../themes/types';\n\n/**\n * 通用按钮组管理器\n * 负责创建和管理除底部工具栏以外的其他按钮组。\n */\nexport class ButtonGroupManager {\n    private activeGroups: BimButtonGroup[] = [];\n    private container: HTMLElement;\n\n    constructor(container: HTMLElement) {\n        this.container = container;\n    }\n\n    /**\n     * 创建一个新的按钮组\n     */\n    public create(options: Omit<ButtonGroupOptions, 'container'>): BimButtonGroup {\n        // 自动创建一个 div 作为容器\n        const groupContainer = document.createElement('div');\n        this.container.appendChild(groupContainer);\n\n        const group = new BimButtonGroup({\n            container: groupContainer,\n            ...options\n        });\n        \n        // 立即初始化\n        group.init();\n        this.activeGroups.push(group);\n        return group;\n    }\n\n    public updateTheme(theme: ThemeConfig) {\n        this.activeGroups.forEach(g => g.setTheme(theme));\n    }\n\n    public refresh() {\n        this.activeGroups.forEach(g => g.render());\n    }\n\n    public destroy() {\n        this.activeGroups.forEach(g => g.destroy());\n        this.activeGroups = [];\n    }\n}\n","import './index.css';\nimport type { DialogOptions } from './index.type';\nimport type { ThemeConfig } from '../../themes/types';\nimport { IBimComponent } from '../../types/component';\nimport { themeManager } from '../../services/theme';\nimport { t, localeManager } from '../../services/locale';\n\n/**\n * 通用弹窗组件类\n * 支持拖拽、缩放、自定义内容和位置。\n */\nexport class BimDialog implements IBimComponent {\n    private element: HTMLElement;\n    private options: DialogOptions;\n    private container: HTMLElement;\n    private header: HTMLElement;\n    private contentArea: HTMLElement;\n    private _isDestroyed = false;\n    private _isInitialized = false;\n    private unsubscribeTheme: (() => void) | null = null;\n    private unsubscribeLocale: (() => void) | null = null;\n\n    /**\n     * 构造函数\n     * @param options 弹窗配置选项\n     */\n    constructor(options: DialogOptions) {\n        // 合并默认配置\n        this.options = {\n            title: 'Dialog',\n            width: 300,\n            height: 'auto',\n            position: 'center',\n            draggable: true,\n            resizable: false,\n            minWidth: 200,\n            minHeight: 100,\n            ...options\n        };\n        this.container = options.container;\n\n        // 创建 DOM 结构\n        this.element = this.createDom();\n        this.header = this.element.querySelector('.bim-dialog-header') as HTMLElement;\n        this.contentArea = this.element.querySelector('.bim-dialog-content') as HTMLElement;\n\n        // 自动初始化 (为了兼容现有逻辑)\n        this.init();\n    }\n\n    /**\n     * 设置主题\n     * @param theme 全局主题配置\n     */\n    public setTheme(theme: ThemeConfig) {\n        const style = this.element.style;\n        if (!this.options.backgroundColor) style.setProperty('--bim-dialog-bg', theme.panelBackground);\n        if (!this.options.headerBackgroundColor) style.setProperty('--bim-dialog-header-bg', theme.componentHover);\n        if (!this.options.titleColor) style.setProperty('--bim-dialog-title-color', theme.textPrimary);\n        if (!this.options.textColor) style.setProperty('--bim-dialog-text-color', theme.textPrimary);\n        if (!this.options.borderColor) style.setProperty('--bim-dialog-border-color', theme.border);\n    }\n\n    /**\n     * 初始化组件功能 (接口实现)\n     */\n    public init() {\n        if (this._isInitialized) return;\n\n        this.container.appendChild(this.element);\n\n        // 必须先挂载才能计算尺寸进行定位\n        this.initPosition();\n\n        if (this.options.draggable) {\n            this.initDrag();\n        }\n\n        if (this.options.resizable) {\n            this.initResize();\n        }\n\n        this._isInitialized = true;\n\n        // 调用弹窗开启后回调\n        if (this.options.onOpen) {\n            this.options.onOpen();\n        }\n\n        // 自动订阅主题变更\n        this.unsubscribeTheme = themeManager.subscribe((theme) => {\n            this.setTheme(theme);\n        });\n\n        // 自动订阅语言变更\n        this.unsubscribeLocale = localeManager.subscribe(() => {\n            this.setLocales();\n        });\n    }\n\n    public setLocales(): void {\n        if (this.options.title) {\n            const titleEl = this.header.querySelector('.bim-dialog-title');\n            if (titleEl) {\n                titleEl.textContent = t(this.options.title);\n            }\n        }\n    }\n\n    /**\n     * 创建弹窗的 DOM 结构\n     */\n    private createDom(): HTMLElement {\n        const el = document.createElement('div');\n        el.className = 'bim-dialog';\n\n        if (this.options.id) el.id = this.options.id;\n\n        // 应用颜色配置到 CSS 变量 (局部作用域)\n        const style = el.style;\n        if (this.options.backgroundColor) style.setProperty('--bim-dialog-bg', this.options.backgroundColor);\n        if (this.options.headerBackgroundColor) style.setProperty('--bim-dialog-header-bg', this.options.headerBackgroundColor);\n        if (this.options.titleColor) style.setProperty('--bim-dialog-title-color', this.options.titleColor);\n        if (this.options.textColor) style.setProperty('--bim-dialog-text-color', this.options.textColor);\n        if (this.options.borderColor) style.setProperty('--bim-dialog-border-color', this.options.borderColor);\n\n        // 设置初始尺寸\n        this.setSize(el, this.options.width, this.options.height);\n\n        // 创建标题栏 (Header)\n        const header = document.createElement('div');\n        header.className = 'bim-dialog-header';\n        if (this.options.draggable) header.classList.add('draggable');\n\n        const title = document.createElement('span');\n        title.className = 'bim-dialog-title';\n        title.textContent = this.options.title ? t(this.options.title) : '';\n\n        const closeBtn = document.createElement('span');\n        closeBtn.className = 'bim-dialog-close';\n        closeBtn.innerHTML = '&times;';\n        closeBtn.onclick = () => this.close();\n\n        header.appendChild(title);\n        header.appendChild(closeBtn);\n\n        // 创建内容区域 (Content)\n        const content = document.createElement('div');\n        content.className = 'bim-dialog-content';\n        if (typeof this.options.content === 'string') {\n            content.innerHTML = this.options.content;\n        } else if (this.options.content instanceof HTMLElement) {\n            content.appendChild(this.options.content);\n        }\n\n        el.appendChild(header);\n        el.appendChild(content);\n\n        // 如果允许缩放，创建缩放手柄\n        if (this.options.resizable) {\n            const resizeHandle = document.createElement('div');\n            resizeHandle.className = 'bim-dialog-resize-handle';\n            el.appendChild(resizeHandle);\n        }\n\n        return el;\n    }\n\n    /**\n     * 设置元素尺寸\n     */\n    private setSize(el: HTMLElement, width?: number | string, height?: number | string) {\n        if (width !== undefined) {\n            el.style.width = typeof width === 'number' ? `${width}px` : width;\n        }\n        if (height !== undefined) {\n            el.style.height = typeof height === 'number' ? `${height}px` : height;\n        }\n    }\n\n    /**\n     * 初始化弹窗位置\n     */\n    private initPosition() {\n        const pos = this.options.position;\n\n        const elRect = this.element.getBoundingClientRect();\n\n        // 计算相对父容器的定位\n        let left = 0;\n        let top = 0;\n\n        const pW = this.container.clientWidth;\n        const pH = this.container.clientHeight;\n        const elW = elRect.width;\n        const elH = elRect.height;\n\n        if (typeof pos === 'object' && 'x' in pos) {\n            left = pos.x;\n            top = pos.y;\n        } else {\n            switch (pos) {\n                case 'center':\n                    left = (pW - elW) / 2;\n                    top = (pH - elH) / 2;\n                    break;\n                case 'top-left': left = 0; top = 0; break;\n                case 'top-center': left = (pW - elW) / 2; top = 0; break;\n                case 'top-right': left = pW - elW; top = 0; break;\n                case 'left-center': left = 0; top = (pH - elH) / 2; break;\n                case 'right-center': left = pW - elW; top = (pH - elH) / 2; break;\n                case 'bottom-left': left = 0; top = pH - elH; break;\n                case 'bottom-center': left = (pW - elW) / 2; top = pH - elH; break;\n                case 'bottom-right': left = pW - elW; top = pH - elH; break;\n                default:\n                    left = (pW - elW) / 2;\n                    top = (pH - elH) / 2;\n            }\n        }\n\n        // 简单的边界检查，防止初始位置溢出\n        left = Math.max(0, Math.min(left, pW - elW));\n        top = Math.max(0, Math.min(top, pH - elH));\n\n        this.element.style.left = `${left}px`;\n        this.element.style.top = `${top}px`;\n    }\n\n    /**\n     * 初始化拖拽功能\n     */\n    private initDrag() {\n        let startX = 0;\n        let startY = 0;\n        let startLeft = 0;\n        let startTop = 0;\n\n        const onMouseDown = (e: MouseEvent) => {\n            e.preventDefault();\n            startX = e.clientX;\n            startY = e.clientY;\n            startLeft = this.element.offsetLeft;\n            startTop = this.element.offsetTop;\n\n            document.addEventListener('mousemove', onMouseMove);\n            document.addEventListener('mouseup', onMouseUp);\n        };\n\n        const onMouseMove = (e: MouseEvent) => {\n            const dx = e.clientX - startX;\n            const dy = e.clientY - startY;\n\n            let newLeft = startLeft + dx;\n            let newTop = startTop + dy;\n\n            // 边界限制，防止拖出容器\n            const maxLeft = this.container.clientWidth - this.element.offsetWidth;\n            const maxTop = this.container.clientHeight - this.element.offsetHeight;\n\n            newLeft = Math.max(0, Math.min(newLeft, maxLeft));\n            newTop = Math.max(0, Math.min(newTop, maxTop));\n\n            this.element.style.left = `${newLeft}px`;\n            this.element.style.top = `${newTop}px`;\n        };\n\n        const onMouseUp = () => {\n            document.removeEventListener('mousemove', onMouseMove);\n            document.removeEventListener('mouseup', onMouseUp);\n        };\n\n        this.header.addEventListener('mousedown', onMouseDown);\n    }\n\n    /**\n     * 初始化缩放功能\n     */\n    private initResize() {\n        const handle = this.element.querySelector('.bim-dialog-resize-handle') as HTMLElement;\n        if (!handle) return;\n\n        let startX = 0;\n        let startY = 0;\n        let startW = 0;\n        let startH = 0;\n\n        const onMouseDown = (e: MouseEvent) => {\n            e.preventDefault();\n            e.stopPropagation();\n            startX = e.clientX;\n            startY = e.clientY;\n            startW = this.element.offsetWidth;\n            startH = this.element.offsetHeight;\n\n            document.addEventListener('mousemove', onMouseMove);\n            document.addEventListener('mouseup', onMouseUp);\n        };\n\n        const onMouseMove = (e: MouseEvent) => {\n            const dx = e.clientX - startX;\n            const dy = e.clientY - startY;\n\n            const newW = Math.max(this.options.minWidth || 100, startW + dx);\n            const newH = Math.max(this.options.minHeight || 50, startH + dy);\n\n            this.element.style.width = `${newW}px`;\n            this.element.style.height = `${newH}px`;\n        };\n\n        const onMouseUp = () => {\n            document.removeEventListener('mousemove', onMouseMove);\n            document.removeEventListener('mouseup', onMouseUp);\n        };\n\n        handle.addEventListener('mousedown', onMouseDown);\n    }\n\n    /**\n     * 动态设置内容\n     * @param content 内容元素或 HTML 字符串\n     */\n    public setContent(content: HTMLElement | string) {\n        this.contentArea.innerHTML = '';\n        if (typeof content === 'string') {\n            this.contentArea.innerHTML = content;\n        } else {\n            this.contentArea.appendChild(content);\n        }\n    }\n\n    /**\n     * 关闭弹窗并销毁\n     */\n    public close() {\n        if (this._isDestroyed) return;\n        if (this.unsubscribeTheme) {\n            this.unsubscribeTheme();\n            this.unsubscribeTheme = null;\n        }\n        if (this.unsubscribeLocale) {\n            this.unsubscribeLocale();\n            this.unsubscribeLocale = null;\n        }\n        this.element.remove();\n        this._isDestroyed = true;\n        if (this.options.onClose) {\n            this.options.onClose();\n        }\n    }\n\n    /**\n     * 销毁组件 (接口实现)\n     */\n    public destroy() {\n        this.close();\n    }\n}\n","import './index.css';\nimport { BimDialog } from '../index';\n\n/**\n * BimInfoDialog (继承版)\n * 这是一个展示项目信息的业务弹窗组件，直接继承自 BimDialog。\n */\nexport class BimInfoDialog extends BimDialog {\n    /**\n     * 构造函数\n     * @param container 父容器\n     */\n    constructor(container: HTMLElement) {\n        // 1. 准备内容 DOM\n        const contentEl = document.createElement('div');\n        contentEl.className = 'bim-info-dialog-content';\n\n        const infoTitle = document.createElement('h3');\n        infoTitle.textContent = 'Model Information';\n\n        const infoList = document.createElement('ul');\n        infoList.innerHTML = `\n            <li><strong>Name:</strong> Sample Project</li>\n            <li><strong>Version:</strong> 1.0.0</li>\n            <li><strong>Date:</strong> ${new Date().toLocaleDateString()}</li>\n            <li><strong>Status:</strong> <span style=\"color: green;\">Active</span></li>\n        `;\n\n        const actionBtn = document.createElement('button');\n        actionBtn.textContent = 'Update Status';\n        actionBtn.style.marginTop = '10px';\n        actionBtn.onclick = () => {\n            alert('Status updated!');\n        };\n\n        contentEl.appendChild(infoTitle);\n        contentEl.appendChild(infoList);\n        contentEl.appendChild(actionBtn);\n\n        // 2. 调用父类构造函数，传入特定的配置\n        super({\n            container: container,\n            title: 'dialog.testTitle',\n            content: contentEl,\n            width: 320,\n            height: 'auto',\n            position: 'center',\n            resizable: true,\n            draggable: true,\n            // 可以在这里添加特定的 onClose 逻辑\n            onClose: () => {\n                console.log('Info dialog closed');\n            },\n            onOpen: () => {\n                console.log('Info dialog opened');\n            }\n        });\n\n        // 3. 如果有特定于子类的初始化逻辑，可以在 super() 之后执行\n        // 例如：this.element.classList.add('my-special-class');\n    }\n\n    // 不需要再手动实现 setTheme, destroy, close, init\n    // 它们都已从 BimDialog 继承\n}","import { BimDialog } from '../components/dialog';\nimport { BimInfoDialog } from '../components/dialog/bimInfoDialog';\nimport type { DialogOptions } from '../components/dialog/index.type';\nimport type { ThemeConfig } from '../themes/types';\nimport { themeManager } from '../services/theme'; // 修正路径\n\n/**\n * 弹窗管理器\n * 负责创建和管理应用中的各类弹窗。\n */\nexport class DialogManager {\n    /** 弹窗挂载的父容器 */\n    private container: HTMLElement;\n    /** 活跃的弹窗实例列表 */\n    private activeDialogs: BimDialog[] = [];\n\n    /**\n     * 构造函数\n     * @param container 弹窗挂载的目标容器\n     */\n    constructor(container: HTMLElement) {\n        this.container = container;\n    }\n\n    /**\n     * 创建一个通用弹窗\n     * @param options 弹窗配置选项（不需要传 container，自动使用管理器绑定的容器）\n     * @returns BimDialog 实例\n     */\n    public create(options: Omit<DialogOptions, 'container'>): BimDialog {\n        const dialog = new BimDialog({\n            container: this.container,\n            ...options,\n            onClose: () => {\n                // 从活跃列表中移除\n                this.activeDialogs = this.activeDialogs.filter(d => d !== dialog);\n                if (options.onClose) options.onClose();\n            }\n        });\n\n        // 应用当前主题\n        dialog.setTheme(themeManager.getTheme());\n\n        this.activeDialogs.push(dialog);\n        return dialog;\n    }\n\n    /**\n     * 显示二次封装的模型信息弹窗\n     * 演示如何调用特定的业务弹窗组件\n     */\n    public showInfoDialog() {\n        // 最佳实践：所有弹窗应通过 create 统一管理，或者手动加入管理。\n        new BimInfoDialog(this.container);\n        // 暂时不做主题追踪，作为遗留逻辑保留\n    }\n\n    /**\n     * 响应全局主题变更\n     * @param theme 全局主题配置\n     */\n    public updateTheme(theme: ThemeConfig) {\n        this.activeDialogs.forEach(dialog => {\n            if (dialog.setTheme) {\n                dialog.setTheme(theme);\n            }\n        });\n    }\n}","import './bim-engine.css';\nimport { ToolbarManager } from './managers/toolbar-manager';\nimport { ButtonGroupManager } from './managers/button-group-manager';\nimport { DialogManager } from './managers/dialog-manager';\nimport { localeManager } from './services/locale';\nimport { themeManager } from './services/theme';\nimport type { LocaleType } from './locales/types';\nimport type { ThemeType, ThemeConfig } from './themes/types';\n\nexport class BimEngine {\n    private container: HTMLElement;\n    private wrapper: HTMLElement | null = null;\n    private topLeftGroup: any = null; // 保存左上角按钮组的引用\n\n    public toolbar: ToolbarManager | null = null;      // 底部专用\n    public buttonGroup: ButtonGroupManager | null = null; // 通用\n    public dialog: DialogManager | null = null;\n\n    public get localeManager() { return localeManager; }\n    public get themeManager() { return themeManager; }\n\n    constructor(container: HTMLElement | string, options?: { locale?: LocaleType; theme?: ThemeType }) {\n        const el = typeof container === 'string' ? document.getElementById(container) : container;\n        if (!el) throw new Error('Container not found');\n        this.container = el;\n\n        if (options?.locale) localeManager.setLocale(options.locale);\n        if (options?.theme) {\n            if (options.theme === 'custom') {\n                console.warn('Custom theme should be set via setCustomTheme().');\n            } else {\n                themeManager.setTheme(options.theme);\n            }\n        }\n\n        this.init();\n    }\n\n    public setLocale(locale: LocaleType) { localeManager.setLocale(locale); }\n    public getLocale(): LocaleType { return localeManager.getLocale(); }\n    public setTheme(theme: 'dark' | 'light') { themeManager.setTheme(theme); }\n    public setCustomTheme(theme: ThemeConfig) { themeManager.setCustomTheme(theme); }\n\n    private init() {\n        this.container.innerHTML = '';\n        this.wrapper = document.createElement('div');\n        this.wrapper.className = 'bim-engine-wrapper';\n        this.container.appendChild(this.wrapper);\n\n        // 初始化管理器\n        this.dialog = new DialogManager(this.wrapper);\n        this.toolbar = new ToolbarManager(this.wrapper);\n        this.buttonGroup = new ButtonGroupManager(this.wrapper);\n\n        // --- 创建左上角按钮组 (需求 1 & 2) ---\n        this.createTopLeftGroup();\n\n        // 初始主题\n        this.updateTheme(themeManager.getTheme());\n\n        // 在主题更新后，设置左上角按钮组的自定义颜色\n        if (this.topLeftGroup) {\n            this.topLeftGroup.setColors({\n                backgroundColor: '#ff00ff'\n            });\n        }\n        themeManager.subscribe((theme) => {\n            this.updateTheme(theme);\n        });\n    }\n\n    private createTopLeftGroup() {\n        if (!this.buttonGroup) return;\n\n        this.topLeftGroup = this.buttonGroup.create({\n            position: 'top-left',\n            direction: 'column',\n            align: 'vertical',\n            backgroundColor: '#ff00ff', // 自定义背景色，不会被主题覆盖\n            showLabel: false\n        });\n\n        this.topLeftGroup.addGroup('main');\n        this.topLeftGroup.addButton({\n            id: 'menu-btn',\n            groupId: 'main',\n            type: 'button',\n            label: 'Menu', // 应该用 translation key\n            icon: '<svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"currentColor\"><path d=\"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z\"/></svg>',\n            onClick: () => {\n                alert(\"点击按钮\")\n            }\n        });\n\n        // 手动 render 一次以显示\n        this.topLeftGroup.render();\n    }\n\n    private updateTheme(theme: ThemeConfig) {\n        if (this.wrapper) {\n            this.wrapper.style.backgroundColor = theme.background;\n            this.wrapper.style.color = theme.textPrimary;\n        }\n    }\n\n    public destroy() {\n        this.toolbar?.destroy();\n        this.buttonGroup?.destroy();\n        this.dialog = null;\n        this.container.innerHTML = '';\n    }\n}\n","import type { ButtonConfig } from '../../../index.type';\n\n/**\n * 首页按钮配置\n */\nexport const homeButton: ButtonConfig = {\n    id: 'home',\n    groupId: 'group-1',\n    type: 'button',\n    label: 'toolbar.home',\n    icon: '<svg width=\"32\" height=\"32\" viewBox=\"0 0 24 24\"><path fill=\"currentColor\" d=\"M4 21V9l8-6l8 6v12h-6v-7h-4v7z\"/></svg>',\n    keepActive: true,\n    onClick: (button) => {\n        console.log('首页按钮被点击:', button.id);\n    }\n};\n","import type { ButtonConfig } from '../../../index.type';\n\n/**\n * 定位按钮配置\n */\nexport const locationButton: ButtonConfig = {\n    id: 'location',\n    groupId: 'group-1',\n    type: 'button',\n    label: 'toolbar.location',\n    icon: '<svg width=\"32\" height=\"32\" viewBox=\"0 0 24 24\"><path fill=\"currentColor\" d=\"M9 13h2v-2.75h2V13h2V8.25l-3-2l-3 2zm3 9q-4.025-3.425-6.012-6.362T4 10.2q0-3.75 2.413-5.975T12 2t5.588 2.225T20 10.2q0 2.5-1.987 5.438T12 22\"/></svg>',\n    keepActive: false,\n    onClick: (button) => {\n        console.log('定位按钮被点击:', button.id);\n    }\n};\n","import type { ButtonConfig } from '../../../../index.type';\n\n/**\n * 漫游菜单按钮配置\n */\nexport const walkMenuButton: ButtonConfig = {\n    id: 'walk',\n    groupId: 'group-1',\n    type: 'menu',\n    label: 'toolbar.walk',\n    align: 'vertical',\n    icon: '<svg width=\"32\" height=\"32\" viewBox=\"0 0 24 24\"><path fill=\"currentColor\" d=\"M9 22V8.775q-2.275-.6-3.637-2.512T4 2h2q0 2.075 1.338 3.538T10.75 7h2.5q.75 0 1.4.275t1.175.8L20.35 12.6l-1.4 1.4L15 10.05V22h-2v-6h-2v6zm3-16q-.825 0-1.412-.587T10 4t.588-1.412T12 2t1.413.588T14 4t-.587 1.413T12 6\"/></svg>',\n    keepActive: true,\n    onClick: (button) => {\n        console.log('漫游按钮被点击:', button.id);\n    }\n};\n","import type { ButtonConfig } from '../../../../index.type';\n\nexport const walkPersonButton: ButtonConfig = {\n    id: 'walk-person',\n    groupId: 'group-1',\n    parentId: 'walk',\n    type: 'button',\n    align: 'vertical',\n    label: 'toolbar.walkPerson',\n    icon: '<svg width=\"32\" height=\"32\" viewBox=\"0 0 24 24\"><path fill=\"currentColor\" d=\"M9 22V8.775q-2.275-.6-3.637-2.512T4 2h2q0 2.075 1.338 3.538T10.75 7h2.5q.75 0 1.4.275t1.175.8L20.35 12.6l-1.4 1.4L15 10.05V22h-2v-6h-2v6zm3-16q-.825 0-1.412-.587T10 4t.588-1.412T12 2t1.413.588T14 4t-.587 1.413T12 6\"/></svg>',\n    onClick: (button) => {\n        console.log('人视漫游被点击:', button.id);\n    }\n};\n","import type { ButtonConfig } from '../../../../index.type';\n\nexport const walkBirdButton: ButtonConfig = {\n    id: 'walk-bird',\n    groupId: 'group-1',\n    parentId: 'walk',\n    align: 'vertical',\n    type: 'button',\n    label: 'toolbar.walkBird',\n    icon: '<svg width=\"32\" height=\"32\" viewBox=\"0 0 24 24\"><path fill=\"currentColor\" d=\"M9 22V8.775q-2.275-.6-3.637-2.512T4 2h2q0 2.075 1.338 3.538T10.75 7h2.5q.75 0 1.4.275t1.175.8L20.35 12.6l-1.4 1.4L15 10.05V22h-2v-6h-2v6zm3-16q-.825 0-1.412-.587T10 4t.588-1.412T12 2t1.413.588T14 4t-.587 1.413T12 6\"/></svg>',\n    onClick: (button) => {\n        console.log('鸟瞰漫游被点击:', button.id);\n    }\n};\n","import type { ButtonConfig } from '../../../index.type';\n\n/**\n * 定位按钮配置\n */\nexport const settingButton: ButtonConfig = {\n    id: 'setting',\n    groupId: 'group-2',\n    type: 'button',\n    label: 'toolbar.setting',\n    icon: '<svg width=\"32\" height=\"32\" viewBox=\"0 0 24 24\"><path fill=\"currentColor\" d=\"m9.25 22l-.4-3.2q-.325-.125-.612-.3t-.563-.375L4.7 19.375l-2.75-4.75l2.575-1.95Q4.5 12.5 4.5 12.338v-.675q0-.163.025-.338L1.95 9.375l2.75-4.75l2.975 1.25q.275-.2.575-.375t.6-.3l.4-3.2h5.5l.4 3.2q.325.125.613.3t.562.375l2.975-1.25l2.75 4.75l-2.575 1.95q.025.175.025.338v.674q0 .163-.05.338l2.575 1.95l-2.75 4.75l-2.95-1.25q-.275.2-.575.375t-.6.3l-.4 3.2zM11 20h1.975l.35-2.65q.775-.2 1.438-.587t1.212-.938l2.475 1.025l.975-1.7l-2.15-1.625q.125-.35.175-.737T17.5 12t-.05-.787t-.175-.738l2.15-1.625l-.975-1.7l-2.475 1.05q-.55-.575-1.212-.962t-1.438-.588L13 4h-1.975l-.35 2.65q-.775.2-1.437.588t-1.213.937L5.55 7.15l-.975 1.7l2.15 1.6q-.125.375-.175.75t-.05.8q0 .4.05.775t.175.75l-2.15 1.625l.975 1.7l2.475-1.05q.55.575 1.213.963t1.437.587zm1.05-4.5q1.45 0 2.475-1.025T15.55 12t-1.025-2.475T12.05 8.5q-1.475 0-2.488 1.025T8.55 12t1.013 2.475T12.05 15.5M12 12\"/></svg>',\n    keepActive: false,\n    onClick: (button) => {\n        console.log('设置按钮被点击:', button.id);\n    }\n};\n","import type { ButtonConfig } from '../../../index.type';\n\n/**\n * 定位按钮配置\n */\nexport const infoButton: ButtonConfig = {\n    id: 'info',\n    groupId: 'group-2',\n    type: 'button',\n    label: 'toolbar.info',\n    icon: '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"32\" height=\"32\" viewBox=\"0 0 24 24\"><path fill=\"currentColor\" d=\"M12 7q.425 0 .713-.288T13 6t-.288-.712T12 5t-.712.288T11 6t.288.713T12 7m0 8q.425 0 .713-.288T13 14v-4q0-.425-.288-.712T12 9t-.712.288T11 10v4q0 .425.288.713T12 15m-6 3l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18z\"/></svg>',\n    keepActive: false,\n    onClick: (button) => {\n        console.log('信息按钮被点击:', button.id);\n    }\n};\n"],"names":["zhCN","enUS","LocaleManager","locale","key","keys","value","k","listener","l","localeManager","t","darkTheme","lightTheme","ThemeManager","themeName","theme","themeManager","BimButtonGroup","options","el","pos","style","margin","themeColors","colorKey","colors","groupId","beforeGroupId","g","newGroup","index","config","parentId","group","button","parentBtn","buttons","id","btn","found","groupElement","total","groupEl","btnWrapper","wrapper","btnEl","iconSize","minWidth","icon","textWrapper","label","arrow","dropdown","btnRect","expand","subBtn","item","dropdownRect","e","buttonId","visible","show","color","Toolbar","homeButton","index$6","locationButton","index$5","walkMenuButton","index$4","walkPersonButton","index$3","walkBirdButton","index$2","settingButton","index$1","infoButton","ToolbarManager","container","v","ButtonGroupManager","groupContainer","BimDialog","titleEl","header","title","closeBtn","content","resizeHandle","width","height","elRect","left","top","pW","pH","elW","elH","startX","startY","startLeft","startTop","onMouseDown","onMouseMove","onMouseUp","dx","dy","newLeft","newTop","maxLeft","maxTop","handle","startW","startH","newW","newH","BimInfoDialog","contentEl","infoTitle","infoList","actionBtn","DialogManager","dialog","d","BimEngine"],"mappings":"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"}